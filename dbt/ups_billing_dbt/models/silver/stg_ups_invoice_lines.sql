{{ config(materialized='table') }}

with src as (
  select
    bronze_row_id,
    file_id,
    load_event_id,
    row_number,
    raw_values,
    ingested_at
  from {{ ref('stg_bronze_invoice_row') }}
)

select
  bronze_row_id,
  file_id,
  load_event_id,
  row_number,
  ingested_at,
  nullif(trim(raw_values->>0), '') as version,
  nullif(trim(raw_values->>1), '') as recipient_number,
  nullif(trim(raw_values->>2), '') as account_number,
  nullif(trim(raw_values->>3), '') as account_country,
  nullif(trim(raw_values->>4), '') as invoice_date,
  nullif(trim(raw_values->>5), '') as invoice_number,
  nullif(trim(raw_values->>6), '') as invoice_type_code,
  nullif(trim(raw_values->>7), '') as invoice_type_detail_code,
  nullif(trim(raw_values->>8), '') as account_tax_id,
  nullif(trim(raw_values->>9), '') as invoice_currency_code,
  nullif(trim(raw_values->>10), '') as invoice_amount,
  nullif(trim(raw_values->>11), '') as transaction_date,
  nullif(trim(raw_values->>12), '') as pickup_record_number,
  nullif(trim(raw_values->>13), '') as lead_shipment_number,
  nullif(trim(raw_values->>14), '') as world_ease_number,
  nullif(trim(raw_values->>15), '') as shipment_reference_number_1,
  nullif(trim(raw_values->>16), '') as shipment_reference_number_2,
  nullif(trim(raw_values->>17), '') as bill_option_code,
  nullif(trim(raw_values->>18), '') as package_quantity,
  nullif(trim(raw_values->>19), '') as oversize_quantity,
  nullif(trim(raw_values->>20), '') as tracking_number,
  nullif(trim(raw_values->>21), '') as package_reference_number_1,
  nullif(trim(raw_values->>22), '') as package_reference_number_2,
  nullif(trim(raw_values->>23), '') as package_reference_number_3,
  nullif(trim(raw_values->>24), '') as package_reference_number_4,
  nullif(trim(raw_values->>25), '') as package_reference_number_5,
  nullif(trim(raw_values->>26), '') as entered_weight,
  nullif(trim(raw_values->>27), '') as entered_weight_unit_of_measure,
  nullif(trim(raw_values->>28), '') as billed_weight,
  nullif(trim(raw_values->>29), '') as billed_weight_unit_of_measure,
  nullif(trim(raw_values->>30), '') as container_type,
  nullif(trim(raw_values->>31), '') as billed_weight_type,
  nullif(trim(raw_values->>32), '') as package_dimensions,
  nullif(trim(raw_values->>33), '') as zone,
  nullif(trim(raw_values->>34), '') as charge_category_code,
  nullif(trim(raw_values->>35), '') as charge_category_detail_code,
  nullif(trim(raw_values->>36), '') as charge_source,
  nullif(trim(raw_values->>37), '') as type_code_1,
  nullif(trim(raw_values->>38), '') as type_detail_code_1,
  nullif(trim(raw_values->>39), '') as type_detail_value_1,
  nullif(trim(raw_values->>40), '') as type_code_2,
  nullif(trim(raw_values->>41), '') as type_detail_code_2,
  nullif(trim(raw_values->>42), '') as type_detail_value_2,
  nullif(trim(raw_values->>43), '') as charge_classification_code,
  nullif(trim(raw_values->>44), '') as charge_description_code,
  nullif(trim(raw_values->>45), '') as charge_description,
  nullif(trim(raw_values->>46), '') as charged_unit_quantity,
  nullif(trim(raw_values->>47), '') as basis_currency_code,
  nullif(trim(raw_values->>48), '') as basis_value,
  nullif(trim(raw_values->>49), '') as tax_indicator,
  nullif(trim(raw_values->>50), '') as transaction_currency_code,
  nullif(trim(raw_values->>51), '') as incentive_amount,
  nullif(trim(raw_values->>52), '') as net_amount,
  nullif(trim(raw_values->>53), '') as miscellaneous_currency_code,
  nullif(trim(raw_values->>54), '') as miscellaneous_incentive_amount,
  nullif(trim(raw_values->>55), '') as miscellaneous_net_amount,
  nullif(trim(raw_values->>56), '') as alternate_invoicing_currency_code,
  nullif(trim(raw_values->>57), '') as alternate_invoice_amount,
  nullif(trim(raw_values->>58), '') as invoice_exchange_rate,
  nullif(trim(raw_values->>59), '') as tax_variance_amount,
  nullif(trim(raw_values->>60), '') as currency_variance_amount,
  nullif(trim(raw_values->>61), '') as invoice_level_charge,
  nullif(trim(raw_values->>62), '') as invoice_due_date,
  nullif(trim(raw_values->>63), '') as alternate_invoice_number,
  nullif(trim(raw_values->>64), '') as store_number,
  nullif(trim(raw_values->>65), '') as customer_reference_number,
  nullif(trim(raw_values->>66), '') as sender_name,
  nullif(trim(raw_values->>67), '') as sender_company_name,
  nullif(trim(raw_values->>68), '') as sender_address_line_1,
  nullif(trim(raw_values->>69), '') as sender_address_line_2,
  nullif(trim(raw_values->>70), '') as sender_city,
  nullif(trim(raw_values->>71), '') as sender_state,
  nullif(trim(raw_values->>72), '') as sender_postal,
  nullif(trim(raw_values->>73), '') as sender_country,
  nullif(trim(raw_values->>74), '') as receiver_name,
  nullif(trim(raw_values->>75), '') as receiver_company_name,
  nullif(trim(raw_values->>76), '') as receiver_address_line_1,
  nullif(trim(raw_values->>77), '') as receiver_address_line_2,
  nullif(trim(raw_values->>78), '') as receiver_city,
  nullif(trim(raw_values->>79), '') as receiver_state,
  nullif(trim(raw_values->>80), '') as receiver_postal,
  nullif(trim(raw_values->>81), '') as receiver_country,
  nullif(trim(raw_values->>82), '') as third_party_name,
  nullif(trim(raw_values->>83), '') as third_party_company_name,
  nullif(trim(raw_values->>84), '') as third_party_address_line_1,
  nullif(trim(raw_values->>85), '') as third_party_address_line_2,
  nullif(trim(raw_values->>86), '') as third_party_city,
  nullif(trim(raw_values->>87), '') as third_party_state,
  nullif(trim(raw_values->>88), '') as third_party_postal,
  nullif(trim(raw_values->>89), '') as third_party_country,
  nullif(trim(raw_values->>90), '') as sold_to_name,
  nullif(trim(raw_values->>91), '') as sold_to_company_name,
  nullif(trim(raw_values->>92), '') as sold_to_address_line_1,
  nullif(trim(raw_values->>93), '') as sold_to_address_line_2,
  nullif(trim(raw_values->>94), '') as sold_to_city,
  nullif(trim(raw_values->>95), '') as sold_to_state,
  nullif(trim(raw_values->>96), '') as sold_to_postal,
  nullif(trim(raw_values->>97), '') as sold_to_country,
  nullif(trim(raw_values->>98), '') as miscellaneous_address_qual_1,
  nullif(trim(raw_values->>99), '') as miscellaneous_address_1_name,
  nullif(trim(raw_values->>100), '') as miscellaneous_address_1_company_name,
  nullif(trim(raw_values->>101), '') as miscellaneous_address_1_address_line_1,
  nullif(trim(raw_values->>102), '') as miscellaneous_address_1_address_line_2,
  nullif(trim(raw_values->>103), '') as miscellaneous_address_1_city,
  nullif(trim(raw_values->>104), '') as miscellaneous_address_1_state,
  nullif(trim(raw_values->>105), '') as miscellaneous_address_1_postal,
  nullif(trim(raw_values->>106), '') as miscellaneous_address_1_country,
  nullif(trim(raw_values->>107), '') as miscellaneous_address_qual_2,
  nullif(trim(raw_values->>108), '') as miscellaneous_address_2_name,
  nullif(trim(raw_values->>109), '') as miscellaneous_address_2_company_name,
  nullif(trim(raw_values->>110), '') as miscellaneous_address_2_address_line_1,
  nullif(trim(raw_values->>111), '') as miscellaneous_address_2_address_line_2,
  nullif(trim(raw_values->>112), '') as miscellaneous_address_2_city,
  nullif(trim(raw_values->>113), '') as miscellaneous_address_2_state,
  nullif(trim(raw_values->>114), '') as miscellaneous_address_2_postal,
  nullif(trim(raw_values->>115), '') as miscellaneous_address_2_country,
  nullif(trim(raw_values->>116), '') as shipment_date,
  nullif(trim(raw_values->>117), '') as shipment_export_date,
  nullif(trim(raw_values->>118), '') as shipment_import_date,
  nullif(trim(raw_values->>119), '') as entry_date,
  nullif(trim(raw_values->>120), '') as direct_shipment_date,
  nullif(trim(raw_values->>121), '') as shipment_delivery_date,
  nullif(trim(raw_values->>122), '') as shipment_release_date,
  nullif(trim(raw_values->>123), '') as cycle_date,
  nullif(trim(raw_values->>124), '') as eft_date,
  nullif(trim(raw_values->>125), '') as validation_date,
  nullif(trim(raw_values->>126), '') as entry_port,
  nullif(trim(raw_values->>127), '') as entry_number,
  nullif(trim(raw_values->>128), '') as export_place,
  nullif(trim(raw_values->>129), '') as shipment_value_amount,
  nullif(trim(raw_values->>130), '') as shipment_description,
  nullif(trim(raw_values->>131), '') as entered_currency_code,
  nullif(trim(raw_values->>132), '') as customs_number,
  nullif(trim(raw_values->>133), '') as exchange_rate,
  nullif(trim(raw_values->>134), '') as master_air_waybill_number,
  nullif(trim(raw_values->>135), '') as epu,
  nullif(trim(raw_values->>136), '') as entry_type,
  nullif(trim(raw_values->>137), '') as cpc_code,
  nullif(trim(raw_values->>138), '') as line_item_number,
  nullif(trim(raw_values->>139), '') as goods_description,
  nullif(trim(raw_values->>140), '') as entered_value,
  nullif(trim(raw_values->>141), '') as duty_amount,
  nullif(trim(raw_values->>142), '') as weight,
  nullif(trim(raw_values->>143), '') as unit_of_measure,
  nullif(trim(raw_values->>144), '') as item_quantity,
  nullif(trim(raw_values->>145), '') as item_quantity_unit_of_measure,
  nullif(trim(raw_values->>146), '') as import_tax_id,
  nullif(trim(raw_values->>147), '') as declaration_number,
  nullif(trim(raw_values->>148), '') as carrier_name_clinical_trial_identification_number_sds_id,
  nullif(trim(raw_values->>149), '') as cccd_number,
  nullif(trim(raw_values->>150), '') as cycle_number,
  nullif(trim(raw_values->>151), '') as foreign_trade_reference_number,
  nullif(trim(raw_values->>152), '') as job_number,
  nullif(trim(raw_values->>153), '') as transport_mode,
  nullif(trim(raw_values->>154), '') as tax_type,
  nullif(trim(raw_values->>155), '') as tariff_code,
  nullif(trim(raw_values->>156), '') as tariff_rate,
  nullif(trim(raw_values->>157), '') as tariff_treatment_number,
  nullif(trim(raw_values->>158), '') as contact_name,
  nullif(trim(raw_values->>159), '') as class_number,
  nullif(trim(raw_values->>160), '') as document_type,
  nullif(trim(raw_values->>161), '') as office_number,
  nullif(trim(raw_values->>162), '') as document_number,
  nullif(trim(raw_values->>163), '') as duty_value,
  nullif(trim(raw_values->>164), '') as total_value_for_duty,
  nullif(trim(raw_values->>165), '') as excise_tax_amount,
  nullif(trim(raw_values->>166), '') as excise_tax_rate,
  nullif(trim(raw_values->>167), '') as gst_amount,
  nullif(trim(raw_values->>168), '') as gst_rate,
  nullif(trim(raw_values->>169), '') as order_in_council,
  nullif(trim(raw_values->>170), '') as origin_country,
  nullif(trim(raw_values->>171), '') as sima_access,
  nullif(trim(raw_values->>172), '') as tax_value,
  nullif(trim(raw_values->>173), '') as total_customs_amount,
  nullif(trim(raw_values->>174), '') as miscellaneous_line_1,
  nullif(trim(raw_values->>175), '') as miscellaneous_line_2,
  nullif(trim(raw_values->>176), '') as miscellaneous_line_3,
  nullif(trim(raw_values->>177), '') as miscellaneous_line_4,
  nullif(trim(raw_values->>178), '') as miscellaneous_line_5,
  nullif(trim(raw_values->>179), '') as payor_role_code,
  nullif(trim(raw_values->>180), '') as miscellaneous_line_7,
  nullif(trim(raw_values->>181), '') as miscellaneous_line_8,
  nullif(trim(raw_values->>182), '') as miscellaneous_line_9,
  nullif(trim(raw_values->>183), '') as miscellaneous_line_10,
  nullif(trim(raw_values->>184), '') as miscellaneous_line_11,
  nullif(trim(raw_values->>185), '') as duty_rate,
  nullif(trim(raw_values->>186), '') as vat_basis_amount,
  nullif(trim(raw_values->>187), '') as vat_amount,
  nullif(trim(raw_values->>188), '') as vat_rate,
  nullif(trim(raw_values->>189), '') as other_basis_amount,
  nullif(trim(raw_values->>190), '') as other_amount,
  nullif(trim(raw_values->>191), '') as other_rate,
  nullif(trim(raw_values->>192), '') as other_customs_number_indicator,
  nullif(trim(raw_values->>193), '') as other_customs_number,
  nullif(trim(raw_values->>194), '') as customs_office_name,
  nullif(trim(raw_values->>195), '') as package_dimension_unit_of_measure,
  nullif(trim(raw_values->>196), '') as original_shipment_package_quantity,
  nullif(trim(raw_values->>197), '') as corrected_zone,
  nullif(trim(raw_values->>198), '') as tax_law_article_number,
  nullif(trim(raw_values->>199), '') as tax_law_article_basis_amount,
  nullif(trim(raw_values->>200), '') as original_tracking_number,
  nullif(trim(raw_values->>201), '') as scale_weight_quantity,
  nullif(trim(raw_values->>202), '') as scale_weight_unit_of_measure,
  nullif(trim(raw_values->>203), '') as raw_dimension_unit_of_measure,
  nullif(trim(raw_values->>204), '') as raw_dimension_length,
  nullif(trim(raw_values->>205), '') as bol_1,
  nullif(trim(raw_values->>206), '') as bol_2,
  nullif(trim(raw_values->>207), '') as bol_3,
  nullif(trim(raw_values->>208), '') as bol_4,
  nullif(trim(raw_values->>209), '') as bol_5,
  nullif(trim(raw_values->>210), '') as po_1,
  nullif(trim(raw_values->>211), '') as po_2,
  nullif(trim(raw_values->>212), '') as po_3,
  nullif(trim(raw_values->>213), '') as po_4,
  nullif(trim(raw_values->>214), '') as po_5,
  nullif(trim(raw_values->>215), '') as po_6,
  nullif(trim(raw_values->>216), '') as po_7,
  nullif(trim(raw_values->>217), '') as po_8,
  nullif(trim(raw_values->>218), '') as po_9,
  nullif(trim(raw_values->>219), '') as po_10,
  nullif(trim(raw_values->>220), '') as nmfc,
  nullif(trim(raw_values->>221), '') as detail_class,
  nullif(trim(raw_values->>222), '') as freight_sequence_number,
  nullif(trim(raw_values->>223), '') as declared_freight_class,
  nullif(trim(raw_values->>224), '') as eori_number,
  nullif(trim(raw_values->>225), '') as detail_keyed_dim,
  nullif(trim(raw_values->>226), '') as detail_keyed_unit_of_measure,
  nullif(trim(raw_values->>227), '') as detail_keyed_billed_dimension,
  nullif(trim(raw_values->>228), '') as detail_keyed_billed_unit_of_measure,
  nullif(trim(raw_values->>229), '') as original_service_description,
  nullif(trim(raw_values->>230), '') as promo_discount_applied_indicator,
  nullif(trim(raw_values->>231), '') as promo_discount_alias,
  nullif(trim(raw_values->>232), '') as sds_match_level_cd,
  nullif(trim(raw_values->>233), '') as sds_rdr_date,
  nullif(trim(raw_values->>234), '') as sds_delivery_date,
  nullif(trim(raw_values->>235), '') as sds_error_code,
  nullif(trim(raw_values->>236), '') as place_holder_46,
  nullif(trim(raw_values->>237), '') as place_holder_47,
  nullif(trim(raw_values->>238), '') as place_holder_48,
  nullif(trim(raw_values->>239), '') as scc_scale_weight,
  nullif(trim(raw_values->>240), '') as place_holder_50,
  nullif(trim(raw_values->>241), '') as place_holder_51,
  nullif(trim(raw_values->>242), '') as place_holder_52,
  nullif(trim(raw_values->>243), '') as place_holder_53
from src
